filter(!is.na(cantidad), cantidad >0) %>%
mutate(fecha = as.Date(zoo::as.yearmon(fecha))) %>%
group_by(fecha, vendedor2) %>%
summarise(cantidad = sum(cantidad))),
"column", hcaes(x = as.Date(fecha), y = cantidad, group = vendedor2)) %>%
hc_xAxis(
title = list(text = "")
) %>%
hc_yAxis(
title = list(text = "Volumen mensual vendido"))
library(zoo)
venta_pret %>% select(gestion, fecha, vendedor, vendedor2, cantidad) %>%
filter(cantidad > 0, !is.na(cantidad)) %>%
group_by(vendedor, gestion, mes = month(fecha)) %>%
mutate(suma = sum(cantidad)) %>%
ungroup() %>%
group_by(gestion, mes) %>%
mutate(promedio = mean(suma)) %>%
ungroup() %>%
mutate(fecha = as.Date(zoo::as.yearmon(fecha))) %>%
select(fecha, promedio) %>% distinct()  %>%
hchart("line",  hcaes(x = as.Date(fecha), y = promedio)) %>%
hc_add_series((venta_pret %>%
#filter(vendedor2 %in% c("Vendedor 3", "Vendedor 9")) %>%
filter(!is.na(cantidad), cantidad >0) %>%
mutate(fecha = as.Date(zoo::as.yearmon(fecha))) %>%
group_by(fecha, vendedor2) %>%
summarise(cantidad = sum(cantidad))),
"column", hcaes(x = as.Date(fecha), y = cantidad, group = vendedor2)) %>%
hc_xAxis(
title = list(text = "")
) %>%
hc_yAxis(
title = list(text = "Volumen mensual vendido"))
venta_pret %>% select(fecha, vendedor, vendedor2, cantidad) %>%
filter(cantidad > 0, !is.na(cantidad)) %>%
filter(vendedor2 %in% c("Vendedor 4", "Vendedor 6")) %>%
hchart("line",  hcaes(x = as.Date(fecha), y = cantidad, group = vendedor2)) %>%
hc_add_series(venta_pret, "scatter", hcaes(x = as.Date(fecha), y = cantidad, group = vendedor))
highchart() %>%
hc_add_series(venta_pret, type = "scatter",
hcaes(x = cantidad, y = precio_bs_m3, group = vendedor2),
headerFormat = "",
marker = list(symbol = "circle")) %>%
hc_tooltip(pointFormat =
"<b>Volumen:<b> {point.cantidad}<br>
<b>Bs/m3:<b> {point.precio_bs_m3}<br>
<b>Cliente:<b> {point.nombre}<br>
<b>Fecha Vaciado:<b> {point.fecha}") %>%
hc_xAxis(title = list(text = "Volumen Venta")) %>%
hc_yAxis(title = list(text = "Precio Bs/m3"))
venta_pret
highchart() %>%
hc_add_series(venta_pret %>%
mutate(fecha = as.Date(fecha,"%Y-%m-%d")),
type = "scatter",
hcaes(x = cantidad, y = precio_bs_m3, group = vendedor2),
headerFormat = "",
marker = list(symbol = "circle")) %>%
hc_tooltip(pointFormat =
"<b>Volumen:<b> {point.cantidad}<br>
<b>Bs/m3:<b> {point.precio_bs_m3}<br>
<b>Cliente:<b> {point.nombre}<br>
<b>Fecha Vaciado:<b> {point.fecha}") %>%
hc_xAxis(title = list(text = "Volumen Venta")) %>%
hc_yAxis(title = list(text = "Precio Bs/m3"))
margen <- rio::import("input/margen_gral.xlsx")
avg_mes <- rio::import("input/promedio_mes_margen.xlsx")
margen <- rio::import("input/margen_gral.xlsx")
avg_mes <- rio::import("input/promedio_mes_margen.xlsx")
avg_mes %>% ggplot(aes(x = as.Date(mes_year), y = margen_bruto_bs )) +
geom_line(color="steelblue") +
geom_point() +
scale_x_date(date_breaks = "months" , date_labels = "%b-%y") +
scale_y_continuous(labels = comma, breaks = seq(0, 700000, by = 100000)) +
theme_ipsum() +
theme(axis.text.x = element_text(angle = 90)) +
xlab("Fecha") + ylab("Bs") +
ggtitle("Margen Bruto Bs")
avg_mes %>% ggplot(aes(x = as.Date(mes_year), y = margen_bruto_bs )) +
geom_line(color="steelblue") +
geom_point() +
scale_x_date(date_breaks = "months" , date_labels = "%b-%y") +
scale_y_continuous(labels = comma, breaks = seq(0, 700000, by = 100000)) +
# theme_ipsum() +
theme(axis.text.x = element_text(angle = 90)) +
xlab("Fecha") + ylab("Bs") +
ggtitle("Margen Bruto Bs")
avg_mes %>% ggplot(aes(x = as.Date(mes_year), y = margen_bruto_bs ))
avg_mes$mes_year
library(tidyverse)
library(scales)
library(highcharter)
library(lubridate)
library(zoo)
avg_mes %>% ggplot(aes(x = as.Date(mes_year), y = margen_bruto_bs )) +
geom_line(color="steelblue") +
geom_point() +
scale_x_date(date_breaks = "months" , date_labels = "%b-%y") +
scale_y_continuous(labels = comma, breaks = seq(0, 700000, by = 100000)) +
# theme_ipsum() +
theme(axis.text.x = element_text(angle = 90)) +
xlab("Fecha") + ylab("Bs") +
ggtitle("Margen Bruto Bs")
avg_mes %>% ggplot(aes(x = as.Date(mes_year), y = margen_bruto_bs ))
library(tidyverse)
library(hrbrthemes)
library(janitor)
library(magrittr)
library(lubridate)
library(kableExtra)
library(highcharter)
library(ggrepel)
library(plotly)
library(scales)
library(zoo)
library(forecast)
avg_mes %>% ggplot(aes(x = as.Date(mes_year), y = margen_bruto_bs )) +
geom_line(color="steelblue") +
geom_point() +
scale_x_date(date_breaks = "months" , date_labels = "%b-%y") +
scale_y_continuous(labels = comma, breaks = seq(0, 700000, by = 100000)) +
# theme_ipsum() +
theme(axis.text.x = element_text(angle = 90)) +
xlab("Fecha") + ylab("Bs") +
ggtitle("Margen Bruto Bs")
as.Date(avg_mes$mes_year)
class(avg_mes$mes_year)
avg_mes$mes_year
as.Date(avg_mes$mes_year)
as.yearmon(avg_mes$mes_year)
avg_mes %>% ggplot(aes(x = as.Date(as.yearmon(avg_mes$mes_year)), y = margen_bruto_bs )) +
geom_line(color="steelblue") +
geom_point() +
scale_x_date(date_breaks = "months" , date_labels = "%b-%y") +
scale_y_continuous(labels = comma, breaks = seq(0, 700000, by = 100000)) +
# theme_ipsum() +
theme(axis.text.x = element_text(angle = 90)) +
xlab("Fecha") + ylab("Bs") +
ggtitle("Margen Bruto Bs")
library(quantmod)
x <- getFX("USD/JPY", auto.assign = FALSE)
hchart(x)
x
hchart(avg_mes, "line", hcaes(x = as.Date(as.yearmon(avg_mes$mes_year)), y = margen_bruto))
hchart(avg_mes, "line", hcaes(x = as.Date(as.yearmon(avg_mes$mes_year)), y = margen_bruto_bs))
avg_mes
names(avg_mes)
margen
names(margen)
hchart(margen, "line", hcaes(x = fecha, y = margen_bruto))
class(margen$fecha)
as.Date(margen$fecha)
hchart(margen, "line", hcaes(x = as.Date(fecha), y = margen_bruto))
names(margen)
marge %>% group_by(fecha) %>%
summarise(precio = sum(precio_total_venta_bs),
costo = sum(costo_total_bs),
margen = precio-costo)
margen %>% group_by(fecha) %>%
summarise(precio = sum(precio_total_venta_bs),
costo = sum(costo_total_bs),
margen = precio-costo)
margen %>% group_by(fecha) %>%
summarise(precio = sum(precio_total_venta_bs),
costo = sum(costo_total_bs),
margen = precio-costo) %>%
arrange(fecha)
hchart(margen %>% group_by(fecha) %>%
summarise(precio = sum(precio_total_venta_bs),
costo = sum(costo_total_bs),
margen = precio-costo) %>%
arrange(fecha),
"line", hcaes(x = as.Date(fecha), y = margen_bruto))
hchart(margen %>% group_by(fecha) %>%
summarise(precio = sum(precio_total_venta_bs),
costo = sum(costo_total_bs),
margen = precio-costo) %>%
arrange(fecha),
"line", hcaes(x = as.Date(fecha), y = margen))
margen %>% group_by(fecha) %>%
summarise(precio = sum(precio_total_venta_bs),
costo = sum(costo_total_bs),
margen = precio-costo) %>%
arrange(fecha)
margen %>% group_by(fecha) %>%
summarise(precio = sum(precio_total_venta_bs),
costo = sum(costo_total_bs),
margen = precio-costo) %>%
gather(tipo, valor, -fecha)
margen %>% group_by(fecha) %>%
summarise(precio = sum(precio_total_venta_bs),
costo = sum(costo_total_bs),
margen = precio-costo) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha)
hchart(margen %>% group_by(fecha) %>%
summarise(precio = sum(precio_total_venta_bs),
costo = sum(costo_total_bs),
margen = precio-costo) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha),
"line", hcaes(x = as.Date(fecha), y = valor, group = tipo))
margen %>% group_by(fecha) %>%
summarise(precio = sum(precio_total_venta_bs),
costo = sum(costo_total_bs),
margen = precio-costo)
margen %>% group_by(fecha) %>%
summarise(precio = sum(precio_total_venta_bs),
costo = sum(costo_total_bs),
margen = precio-costo) %>%
mutate(costo = (-costo))
margen %>% group_by(fecha) %>%
summarise(precio = sum(precio_total_venta_bs),
costo = sum(costo_total_bs),
margen = precio-costo) %>%
mutate(costo = (-costo)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha)
hchart(margen %>% group_by(fecha) %>%
summarise(precio = sum(precio_total_venta_bs),
costo = sum(costo_total_bs),
margen = precio-costo) %>%
mutate(costo = (-costo)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha),
"line", hcaes(x = as.Date(fecha), y = valor, group = tipo))
hchart(margen %>% group_by(fecha) %>%
summarise(precio_m3 = avg(precio_bs_m3),
costo_m3 = avg(costo_total_bs_m3),
margen_m3 = avg(margen_bs_m3)) %>%
mutate(costo = (-costo)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha),
"line",
hcaes(x = as.Date(fecha), y = valor, group = tipo))
margen %>% group_by(fecha) %>%
summarise(precio_m3 = avg(precio_bs_m3),
costo_m3 = avg(costo_total_bs_m3),
margen_m3 = avg(margen_bs_m3)) %>%
mutate(costo = (-costo)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha)
margen %>% group_by(fecha) %>%
summarise(precio_m3 = avg(precio_bs_m3),
costo_m3 = avg(costo_total_bs_m3),
margen_m3 = avg(margen_bs_m3))
margen %>% group_by(fecha) %>%
summarise(precio_m3 = avg(precio_bs_m3),
costo_m3 = avg(costo_total_bs_m3),
margen_m3 = avg(margen_bs_m3))
hchart(margen %>% group_by(fecha) %>%
summarise(precio_m3 = mean(precio_bs_m3),
costo_m3 = mean(costo_total_bs_m3),
margen_m3 = mean(margen_bs_m3)) %>%
mutate(costo = (-costo_m3)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha),
"line",
hcaes(x = as.Date(fecha), y = valor, group = tipo))
hchart(margen %>% group_by(fecha) %>%
summarise(precio_m3 = mean(precio_bs_m3),
costo_m3 = mean(costo_total_bs_m3),
margen_m3 = mean(margen_bs_m3)) %>%
mutate(costo_m3 = (-costo_m3)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha),
"line",
hcaes(x = as.Date(fecha), y = valor, group = tipo))
hchart(margen %>% group_by(fecha) %>%
summarise(precio = sum(precio_total_venta_bs),
costo = sum(costo_total_bs),
margen = precio-costo) %>%
mutate(costo = (-costo)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha),
"line",
hcaes(x = as.Date(fecha), y = valor, group = tipo))
hchart(margen %>% group_by(fecha) %>%
summarise(precio = sum(precio_total_venta_bs),
costo = sum(costo_total_bs),
margen = precio-costo) %>%
mutate(costo = (-costo)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha),
"line",
hcaes(x = as.Date(fecha), y = valor, group = tipo)) %>%
hc_colors(c("#7bc043" ,"#ee4035", "#f37736"))
hchart(margen %>% group_by(fecha) %>%
summarise(precio = sum(precio_total_venta_bs),
costo = sum(costo_total_bs),
margen = precio-costo) %>%
mutate(costo = (-costo)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha),
"line",
hcaes(x = as.Date(fecha), y = valor, group = tipo)) %>%
hc_colors(c("#ee4035" ,"#0392cf", "#7bc043"))
hchart(margen %>% group_by(fecha) %>%
summarise(precio_m3 = mean(precio_bs_m3),
costo_m3 = mean(costo_total_bs_m3),
margen_m3 = mean(margen_bs_m3)) %>%
mutate(costo_m3 = (-costo_m3)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha),
"line",
hcaes(x = as.Date(fecha), y = valor, group = tipo)) %>%
hc_colors(c("#ee4035" ,"#0392cf", "#7bc043"))
hchart(margen %>% group_by(fecha) %>%
summarise(`Precio total` = sum(precio_total_venta_bs),
`Costo total` = sum(costo_total_bs),
`Margen` = `Precio total`-`Costo total`) %>%
mutate(`Costo total` = (-`Costo total`)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha),
"line",
hcaes(x = as.Date(fecha), y = valor, group = tipo)) %>%
hc_colors(c("#ee4035" ,"#0392cf", "#7bc043"))
hchart(margen %>% group_by(fecha) %>%
summarise(`Precio por m3` = mean(precio_bs_m3),
`Costo por m3` = mean(costo_total_bs_m3),
`Margen por m3` = mean(margen_bs_m3)) %>%
mutate(costo_m3 = (-`Costo por m3`)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha),
"line",
hcaes(x = as.Date(fecha), y = valor, group = tipo)) %>%
hc_colors(c("#ee4035" ,"#0392cf", "#7bc043"))
title = list(text = "Valor en Bs.")) %>%
hc_xAxis(
hchart(margen %>% group_by(fecha) %>%
summarise(`Precio total` = sum(precio_total_venta_bs),
`Costo total` = sum(costo_total_bs),
`Margen` = `Precio total`-`Costo total`) %>%
mutate(`Costo total` = (-`Costo total`)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha),
"line",
hcaes(x = as.Date(fecha), y = valor, group = tipo)) %>%
hc_colors(c("#ee4035" ,"#0392cf", "#7bc043")) %>%
hc_yAxis(
title = list(text = "Valor en Bs.")) %>%
hc_xAxis(
title = list(text = ""))
hchart(margen %>% group_by(fecha) %>%
summarise(`Precio total` = sum(precio_total_venta_bs),
`Costo total` = sum(costo_total_bs),
`Margen` = `Precio total`-`Costo total`) %>%
mutate(`Costo total` = (-`Costo total`)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha),
"line",
hcaes(x = as.Date(fecha), y = valor, group = tipo)) %>%
hc_colors(c("#ee4035" ,"#0392cf", "#7bc043"))
hchart(margen %>% group_by(fecha) %>%
summarise(`Precio total` = sum(precio_total_venta_bs),
`Costo total` = sum(costo_total_bs),
`Margen` = `Precio total`-`Costo total`) %>%
mutate(`Costo total` = (-`Costo total`)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha),
"line",
hcaes(x = as.Date(fecha), y = valor, group = tipo)) %>%
hc_colors(c("#ee4035" ,"#0392cf", "#7bc043")) %>%
hc_yAxis(title = list(text = "Valor en Bs."))
hchart(margen %>% group_by(fecha) %>%
summarise(`Precio total` = sum(precio_total_venta_bs),
`Costo total` = sum(costo_total_bs),
`Margen` = `Precio total`-`Costo total`) %>%
mutate(`Costo total` = (-`Costo total`)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha),
"line",
hcaes(x = as.Date(fecha), y = valor, group = tipo)) %>%
hc_colors(c("#ee4035" ,"#0392cf", "#7bc043")) %>%
hc_yAxis(title = list(text = "Valor en Bs.")) %>%
hc_xAxis(title = list(text = ""))
hchart(margen %>% group_by(fecha) %>%
summarise(`Precio por m3` = mean(precio_bs_m3),
`Costo por m3` = mean(costo_total_bs_m3),
`Margen por m3` = mean(margen_bs_m3)) %>%
mutate(costo_m3 = (-`Costo por m3`)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha),
"line",
hcaes(x = as.Date(fecha), y = valor, group = tipo)) %>%
hc_colors(c("#ee4035" ,"#0392cf", "#7bc043")) %>%
hc_yAxis(title = list(text = "Valor en Bs. por m3")) %>%
hc_xAxis(title = list(text = ""))
hchart(margen %>% group_by(fecha) %>%
summarise(`Precio por m3` = mean(precio_bs_m3),
`Costo por m3` = mean(costo_total_bs_m3),
`Margen por m3` = mean(margen_bs_m3)) %>%
mutate(`Costo por m3` = (-`Costo por m3`)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha),
"line",
hcaes(x = as.Date(fecha), y = valor, group = tipo)) %>%
hc_colors(c("#ee4035" ,"#0392cf", "#7bc043")) %>%
hc_yAxis(title = list(text = "Valor en Bs. por m3")) %>%
hc_xAxis(title = list(text = ""))
names(margen)
margen %>% group_by(mes_year) %>%
summarise(`Precio por m3` = mean(precio_bs_m3),
`Costo por m3` = mean(costo_total_bs_m3),
`Margen por m3` = mean(margen_bs_m3)) %>%
mutate(`Costo por m3` = (-`Costo por m3`))
margen %>% group_by(month(fecha), year(fecha)) %>%
summarise(`Precio por m3` = mean(precio_bs_m3),
`Costo por m3` = mean(costo_total_bs_m3),
`Margen por m3` = mean(margen_bs_m3)) %>%
mutate(`Costo por m3` = (-`Costo por m3`)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha)
margen %>% group_by(month(fecha), year(fecha)) %>%
summarise(`Precio por m3` = mean(precio_bs_m3),
`Costo por m3` = mean(costo_total_bs_m3),
`Margen por m3` = mean(margen_bs_m3)) %>%
mutate(`Costo por m3` = (-`Costo por m3`))
margen %>% group_by(month(fecha), year(fecha)) %>%
summarise(`Precio por m3` = mean(precio_bs_m3),
`Costo por m3` = mean(costo_total_bs_m3),
`Margen por m3` = mean(margen_bs_m3)) %>%
mutate(`Costo por m3` = (-`Costo por m3`))
margen %>% group_by(mes = month(fecha), gestion =year(fecha)) %>%
summarise(`Precio por m3` = mean(precio_bs_m3),
`Costo por m3` = mean(costo_total_bs_m3),
`Margen por m3` = mean(margen_bs_m3)) %>%
mutate(`Costo por m3` = (-`Costo por m3`))
margen %>% group_by(mes = month(fecha), gestion =year(fecha)) %>%
summarise(`Precio por m3` = mean(precio_bs_m3),
`Costo por m3` = mean(costo_total_bs_m3),
`Margen por m3` = mean(margen_bs_m3)) %>%
mutate(`Costo por m3` = (-`Costo por m3`))
margen %>% group_by(mes = month(fecha), gestion =year(fecha)) %>%
summarise(`Precio por m3` = mean(precio_bs_m3),
`Costo por m3` = mean(costo_total_bs_m3),
`Margen por m3` = mean(margen_bs_m3)) %>%
mutate(`Costo por m3` = (-`Costo por m3`))
hchart(margen %>% group_by(mes = month(fecha), gestion =year(fecha)) %>%
summarise(`Precio por m3` = mean(precio_bs_m3),
`Costo por m3` = mean(costo_total_bs_m3),
`Margen por m3` = mean(margen_bs_m3)) %>%
mutate(`Costo por m3` = (-`Costo por m3`)),
"line",
hcaes(x = mes, y = `Precio por m3`, group = gestion)) %>%
hc_yAxis(title = list(text = "Precio en Bs. por m3")) %>%
hc_xAxis(title = list(text = ""))
month(1)
month.name
month.name(1)
month.name()[1]
month.name()
month.name[1]
hchart(margen %>% group_by(mes = month(fecha), gestion =year(fecha)) %>%
summarise(`Precio por m3` = mean(precio_bs_m3),
`Costo por m3` = mean(costo_total_bs_m3),
`Margen por m3` = mean(margen_bs_m3)) %>%
mutate(`Costo por m3` = (-`Costo por m3`)),
"line",
hcaes(x = month.name[mes], y = `Precio por m3`, group = gestion)) %>%
hc_yAxis(title = list(text = "Precio en Bs. por m3")) %>%
hc_xAxis(title = list(text = ""))
margen %>% group_by(fecha) %>%
summarise(`Precio total` = sum(precio_total_venta_bs),
`Costo total` = sum(costo_total_bs),
`Margen` = `Precio total`-`Costo total`) %>%
mutate(`Costo total` = (-`Costo total`))
margen %>% group_by(mes = month(fecha), gestion =year(fecha)) %>%
summarise(`Precio total` = sum(precio_total_venta_bs),
`Costo total` = sum(costo_total_bs),
`Margen` = `Precio total`-`Costo total`) %>%
mutate(`Costo total` = (-`Costo total`))
# comparacion costo/m3
hchart(margen %>% group_by(mes = month(fecha), gestion =year(fecha)) %>%
summarise(`Precio por m3` = mean(precio_bs_m3),
`Costo por m3` = mean(costo_total_bs_m3),
`Margen por m3` = mean(margen_bs_m3)),
"line",
hcaes(x = month.name[mes], y = `Costo por m3`, group = gestion)) %>%
hc_yAxis(title = list(text = "Precio en Bs. por m3")) %>%
hc_xAxis(title = list(text = ""))
# comparacion margen/m3
hchart(margen %>% group_by(mes = month(fecha), gestion =year(fecha)) %>%
summarise(`Precio por m3` = mean(precio_bs_m3),
`Costo por m3` = mean(costo_total_bs_m3),
`Margen por m3` = mean(margen_bs_m3)),
"line",
hcaes(x = month.name[mes], y = `Margen por m3`, group = gestion)) %>%
hc_yAxis(title = list(text = "Margen en Bs. por m3")) %>%
hc_xAxis(title = list(text = ""))
# costo total
hchart(margen %>% group_by(mes = month(fecha), gestion =year(fecha)) %>%
summarise(`Precio total` = sum(precio_total_venta_bs),
`Costo total` = sum(costo_total_bs),
`Margen` = `Precio total`-`Costo total`),
"line",
hcaes(x = month.name[mes], y = `Costo total`, group = gestion)) %>%
hc_yAxis(title = list(text = "Costo total en Bs.")) %>%
hc_xAxis(title = list(text = ""))
hchart(margen %>% group_by(fecha) %>%
summarise(`Precio total` = sum(precio_total_venta_bs),
`Costo total` = sum(costo_total_bs),
`Margen` = `Precio total`-`Costo total`) %>%
mutate(`Costo total` = (-`Costo total`)) %>%
gather(tipo, valor, -fecha) %>%
arrange(fecha),
"line",
hcaes(x = as.Date(fecha), y = valor, group = tipo)) %>%
hc_colors(c("#ee4035" ,"#0392cf", "#7bc043")) %>%
hc_yAxis(title = list(text = "Valor en Bs.")) %>%
hc_xAxis(title = list(text = ""))
